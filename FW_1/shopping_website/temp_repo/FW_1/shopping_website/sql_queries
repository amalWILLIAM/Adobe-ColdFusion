create database shopping_db;

use shopping_db;

create table users(
user_id int primary key auto_increment,
username varchar(100) unique not null,
email varchar(100) unique not null,
password varchar(100) not null,
role enum('admin','user') not null default 'user',
created_at datetime default CURRENT_TIMESTAMP,
updated_at datetime default current_timestamp on update current_timestamp
);

create table products(
product_id int primary key auto_increment,
name varchar(100) not null,
description varchar(100),
price decimal(10,2) not null,
stock_quantity int not null,
created_at datetime default CURRENT_TIMESTAMP,
updated_at datetime default current_timestamp on update current_timestamp
);

create table orders(
order_id int primary key auto_increment,
user_id int not null,
total_amount decimal(10,2) not null,
status enum('pending','completed','cancelled') not null default 'pending',
created_at datetime default CURRENT_TIMESTAMP,
updated_at datetime default current_timestamp on update current_timestamp,
constraint fk_order_user
foreign key (user_id)
references users(user_id)
on update cascade
on delete cascade
);

create table order_items(
order_item_id int primary key auto_increment,
order_id int not null,
product_id int not null,
quantity int not null,
price decimal(10,2) not null,
constraint fk_orderitems_order
foreign key (order_id)
references orders(order_id)
on update cascade
on delete cascade,
constraint fk_orderitems_product
foreign key (product_id)
references products(product_id)
on update cascade
on delete cascade
);

create table cart(
cart_id int primary key auto_increment,
user_id int not null,
product_id int not null,
quantity int not null,
constraint fk_cart_user
foreign key (user_id)
references users(user_id)
on update cascade
on delete cascade,
constraint fk_cart_product
foreign key (product_id)
references products(product_id)
on update cascade
on delete cascade
);

